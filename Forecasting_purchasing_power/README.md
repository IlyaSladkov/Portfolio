## Описание проекта

Интернет-магазин «В один клик» продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты. Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться. Привлекать новых клиентов уже не так эффективно: о магазине и так знает большая часть целевой аудитории. Возможный выход — удерживать активность постоянных клиентов. Сделать это можно с помощью персонализированных предложений.

«В один клик» — современная компания, поэтому её руководство не хочет принимать решения просто так — только на основе анализа данных и бизнес-моделирования. У компании есть небольшой отдел цифровых технологий, и вам предстоит побыть в роли стажёра в этом отделе.

Итак, вашему отделу поручили разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.

## Цель работы

1) Нужно промаркировать уровень финансовой активности постоянных покупателей. В компании принято выделять два уровня активности: «снизилась», если клиент стал покупать меньше товаров, и «прежний уровень».

2) Нужно собрать данные по клиентам по следующим группам:
- Признаки, которые описывают коммуникацию сотрудников компании с клиентом.
- Признаки, которые описывают продуктовое поведение покупателя. Например, какие товары покупает и как часто.
- Признаки, которые описывают покупательское поведение клиента. Например, сколько тратил в магазине.
- Признаки, которые описывают поведение покупателя на сайте. Например, как много страниц просматривает и сколько времени проводит на сайте.

3) Нужно построить модель, которая предскажет вероятность снижения покупательской активности клиента в следующие три месяца.

4) В исследование нужно включить дополнительные данные финансового департамента о прибыльности клиента: какой доход каждый покупатель приносил компании за последние три месяца.

5) Используя данные модели и данные о прибыльности клиентов, нужно выделить сегменты покупателей и разработать для них персонализированные предложения.

## Общий вывод

В данной работе разработана модель, которая предсказывает вероятность снижения покупательской активности.

Данные были получены из следующих файлов /datasets/market_file.csv, /datasets/market_money.csv, /datasets/market_time.csv, /datasets/money.csv. Перед началом исследовательской части был произведен обзор и проверка на адекватность полученных данных. Выявлено, что:

- в money.csv столбцы разделены знаком ";"
- столбец Прибыль в таблицы money имеет неверный тип (object), решено заменить на float
- данные в файлах соответствуют описанию данных

Перед началом исследования была проведена предобработка данных,в рамках которой выялено:

- явных дубликатов и пропусков в данных не обнаружено

В ходе исследования данных выявлены следующие особенности:

**Анализ market_file**
- у столбцов 'Маркет_актив_6_мес', 'Маркет_актив_тек_мес', 'Длительность', 'Средний_просмотр_категорий_за_визит', 'Ошибка_сервиса' наблюдается нормальное распредление
- у столбов 'Неоплаченные_продукты_штук_квартал', 'Страниц_за_визит' наблюдается распределение Пауссона
- у столбца 'Акционные_покупки' наблюдается разделение на 2 категории покупателей: нормальные (доля акционных товаров в среднем 0.24) и покупатели товаров по акции (доля акционных тоаров свыше 0.8)
- у стобца 'Покупательская_активность' преобладает категория 'Прежний уровень'
- у стобца 'Тип сервиса' преобладает категория 'стандарт'
- у стобца 'Разрешить сообщать' преобладает категория 'Да'
- самая популярная категория товара 'Товары для детей'
- в столбце 'Тип сервиса' найден багрепорт 'стандартт'

**Анализ market_money:**
- в столбце 'Выручка' найдено много выбросов в районе 0, это связано с тем, что некоторых пользоватей в определенный месяц не было совершено покупок
- в столбце 'Выручка' найдено 1 аномальное значение 106862.2, решено его убрать из рассмотрения
- у столбца 'Выручка' наблюдается нормальное распредление
- в столбце 'Период' замечена категория 'препредыдущий_месяц', стоит уточнить у специалиста, что это: багрепорт или граматическая ошибка (предпредыдущий)

**Анализ market_time**
- у столбца 'минут' наблюдается нормальное распредление
- в столбце 'Период' замечена категория 'предыдцщий_месяц' с граматической ошибкой (предыдущий)
- у стобца 'Период' сбалансированная выборка

**Анализ money**
- у столбца 'Прибыль' наблюдается нормальное распредление

Для разработки модели все исследуемые данные были сведены в одну таблицу:

- загруженные данные исследуемых файлов были объеденены в одну таблицу, для дальнейшего создания модели с этими признаками
- созданы отдельные столбецы для каждого периода по выручке и активности на сайте
- все исследуемые пользователи совершали покупки  течении последних 3 месяцев

Для предотвращения мультиколиерности признаков, был проведен корреляционный анализ, который показал:

- наблюдается высокая зависимость между Выручка_предыдущий_месяц от Выручка_текущий_месяц, что приведет к мультиколинеарсности признаков, решено заменить эти два признака на их сумму

Для автоматизации подбора гиперпараметров при разработки модели был использован пайплан, в рамках которого:

- при разработке модели важно минимизировать ошибки обоих родов, и при исследование используется не сбалансированная выборка,  поэтому будет использоваться метрика ROC-AUC
- для оптимазиции времени расчета первые варианты модели с расширенным списком гиперпараметров были проверены благодаря RandomizedSearchCV, а более точные варинты гиперпараметров уже были получены с использованием OptunaSearchCV
- наилучшие показания метрики показывает модель Логистической регрессии с следующеми гиперпараметрами (C=5, class_weight='balanced', max_iter=200,penalty='l1',solver='liblinear')
- наблюдается снижение метрики на тестовой выборке, это может говорить о переобученности модели, необходимо провести анализ важности признаков)

Для улучшения метрики модели был проведен анализ важности признаков, в рамках которого:

- Добавление полиномных признаков позволило улучшить метрику на 1,7%
- Наилучшие показания метрики можно достичь при использовании 94 признаков из 98 используемых в модели
- Наиболее важными признаками для оценки покупательской активности оказались признаки характеризующие Поведение на сайте (Страниц_за_визит, Минут_текущий_мес, Минут_предыдущий_мес)

По полученным ранее исследовательскому анализу и подготовленной модели была проведена сегментация покупателей и предлождены рекомендации по улучшению бизнеса:

- Для поддержания покупательской активности клиентов рекомендуется проводить мероприятия по удержанию пользователей на сайте "В один клик"
- Для удержания пользователей рекомендуются использовать промо-акции для клиентов предсказанных разработанной моделью
- Так для покупателей с долей акционных товаров свыше 0.8 (см. Исследовательский анализ) и предсказанным снижением покупательской активности рекомендуется присылать список акционных товаров на текущий момент или купоны на скидку на определенны товары
- Для покупателей в списке покупок которых товар из группы техники свыше 13% (см. Исследовательский анализ) рекомендуется в первой строчке предложенных товаров указывать товары из техники, подобную стратегию также рекомендуется использовать для покупателей у которых «Товары для себя» превышают 14%

